<?xml version="1.0" encoding="UTF-8"?>
<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans
			http://www.springframework.org/schema/beans/spring-beans.xsd
			http://www.springframework.org/schema/aop
			http://www.springframework.org/schema/aop/spring-aop.xsd">



	<!-- 管理者権限チェックアドバイス 帳票ワークスペース管理-->
	<bean id="formWorkspaceAdminAuthorityCheckAdvice" parent="adminAuthorityCheckAdvice">
		<property name="authorizationIdList">
			<list>
				<value>formworkspace</value>
			</list>
		</property>
	</bean>

	<!-- 管理者権限チェックアドバイス コード管理-->
	<bean id="codeAdminAuthorityCheckAdvice" parent="adminAuthorityCheckAdvice">
		<property name="authorizationIdList">
			<list>
				<value>general</value>
				<value>attribute</value>
				<value>task</value>
			</list>
		</property>
	</bean>

	<!-- 管理者権限チェックアドバイス キャッシュ管理-->
	<bean id="cacheAdminAuthorityCheckAdvice" parent="adminAuthorityCheckAdvice">
		<property name="authorizationIdList">
			<list>
				<value>general</value>
			</list>
		</property>
	</bean>


	<aop:config>

		<aop:aspect order="10" ref="formWorkspaceAdminAuthorityCheckAdvice">

			<!-- 帳票ワークスペース新規　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.app.form.business.service.FormWorkspaceService.create(..))"
			/>

			<!-- 帳票ワークスペース更新　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.app.form.business.service.FormWorkspaceService.updateName(..))"
			/>

			<!-- 帳票ワークスペース削除　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.app.form.business.service.FormWorkspaceService.delete(..))"
			/>

			<!-- 帳票ワークスペース割り当て　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.app.form.business.service.FormWorkspaceService.addFormType(..))"
			/>
		</aop:aspect>


		<aop:aspect order="10" ref="codeAdminAuthorityCheckAdvice">

			<!-- コードタイプ新規　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeTypeService.create(..))"
			/>

			<!-- コードタイプ編集　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeTypeService.update(..))"
			/>

			<!-- コードタイプ複写　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeTypeService.copy(..))"
			/>

			<!-- コードタイプ削除　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeTypeService.delete(..))"
			/>

			<!-- コード新規　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeService.create(..))"
			/>

			<!-- コード編集　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeService.update(..))"
			/>

			<!-- コード削除　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeService.delete(..))"
			/>

			<!-- コード並び替え　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.framework2.business.service.CodeService.sortSequence(..))"
			/>
		</aop:aspect>

		<aop:aspect order="10" ref="cacheAdminAuthorityCheckAdvice">

			<!-- ノード一覧取得　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.admin.business.service.CacheMonitorViewService.getNodes(..))"
			/>

			<!-- キャッシュ領域一覧取得　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.admin.business.service.CacheMonitorViewService.getCaches(..))"
			/>

			<!-- キャッシュエントリ検索　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.admin.business.service.CacheMonitorViewService.searchEntries(..))"
			/>

			<!-- キャッシュエントリリロード　管理者権限チェック -->
			<aop:before
				method="check"
				pointcut="execution(* jp.co.ctc_g.eim.admin.business.service.CacheMonitorViewService.reload(..))"
			/>
		</aop:aspect>

	</aop:config>

</beans>


