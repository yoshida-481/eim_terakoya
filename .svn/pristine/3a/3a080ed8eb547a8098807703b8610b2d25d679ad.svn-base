<?xml version="1.0" encoding="UTF-8"?>
<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans
			http://www.springframework.org/schema/beans/spring-beans.xsd
			http://www.springframework.org/schema/aop
			http://www.springframework.org/schema/aop/spring-aop.xsd">

	<!--                    -->
	<!--  ドキュメント操作  -->
	<!--                    -->
	<!-- ページダウンロード権限チェックアドバイス -->
	<bean id="pageAccessAuthorityCheckAdvice" parent="accessAuthorityCheckAdvice">
		<property name="accessRoleTypeName" value="READ"/>
		<property name="accessErrorCode" value="EIM.ERROR.LOGIC.NOACCESS"/>
		<!-- パラメータ変換 -->
	 	<property name="parameterConverter" ref="accessCheckIdToObjectConverter"/>
	</bean>
	
	<!-- 公開PDF事前登録 権限チェックアドバイス -->
	<bean id="preRegistPublicPdfAccessAuthorityCheckAdvice" parent="accessAuthorityCheckAdvice">
		<property name="accessRoleTypeName" value="UPDATE"/>
		<property name="accessErrorCode" value="EIM.ERROR.LOGIC.NOACCESS"/>
	</bean>

	<!-- IDからObjectDomainを生成 -->
	<bean id="accessCheckIdToObjectConverter" class="jp.co.ctc_g.eim.app.document.common.aop.plugin.impl.IdToObjectConverterPlugInImpl"/>

	<aop:config>
		<!-- ページダウンロード権限チェック -->
		<aop:aspect order="10" ref="pageAccessAuthorityCheckAdvice">
			<aop:before
				method="check"
				arg-names="arg0"
				pointcut="execution(* jp.co.ctc_g.eim.search.core.searchApi.presentation.controller.FileDownloadController.getPage(..)) and args(arg0,..)"
			/>
		</aop:aspect>
	
	</aop:config>
	
	<aop:config>
		<!-- 公開PDF事前登録 権限チェック -->
		<aop:aspect order="10" ref="preRegistPublicPdfAccessAuthorityCheckAdvice">
			<aop:before
				method="check"
				arg-names="arg0"
				pointcut="execution(* jp.co.ctc_g.eim.app.document.business.service.PublicDocumentService.preRegistPublicPdf(..,..)) and args(arg0,..)"
			/>
		</aop:aspect>
	</aop:config>
	
	<aop:config>
		<!-- 事前登録公開PDF削除 権限チェック -->
		<aop:aspect order="10" ref="preRegistPublicPdfAccessAuthorityCheckAdvice">
			<aop:before
				method="check"
				arg-names="arg0"
				pointcut="execution(* jp.co.ctc_g.eim.app.document.business.service.PublicDocumentService.deletePreRegistPdf(..)) and args(arg0)"
			/>
		</aop:aspect>
	</aop:config>
</beans>

