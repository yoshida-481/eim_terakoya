<?xml version="1.0" encoding="UTF-8"?>
<infinispan
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:infinispan:config:15.2 https://infinispan.org/schemas/infinispan-config-15.2.xsd"
	xmlns="urn:infinispan:config:15.2">

	<!-- =============================================================================== -->
	<!-- ドキュメント管理アプリケーションのためのキャッシュ設定                          -->
	<!--   ドキュメント管理で使用する全てのオブジェクトタイプのキャッシュを有効にします。-->
	<!-- =============================================================================== -->

	<cache-container>
		<transport stack="tcp" node-name="${eimCacheNodeName}" />

		<serialization marshaller="org.infinispan.commons.marshall.JavaSerializationMarshaller">
			<allow-list>
				<regex>java.*</regex>
				<regex>jp.co.ctc_g.eim.framework2.*</regex>
			</allow-list>
		</serialization>

		<!-- 共通設定(キャッシュ無制限) -->
		<replicated-cache-configuration name="Common" mode="SYNC">
			<persistence passivation="false">
				<file-store path="CacheFiles/${eimCacheNodeName}" />
			</persistence>
			<state-transfer timeout="9223372036854775807" />
		</replicated-cache-configuration>

		<!-- 共通設定(キャッシュしない設定) -->
		<replicated-cache-configuration name="NoCache" mode="SYNC">
			<persistence passivation="false">
				<file-store path="CacheFiles/${eimCacheNodeName}" />
			</persistence>
			<memory max-count="0" />
		</replicated-cache-configuration>

		<!-- 共通トランザクション設定 -->
		<replicated-cache-configuration name="Common-Transaction" mode="SYNC">
			<locking isolation="READ_COMMITTED" />
			<!-- トランザクションタイムアウト時間:15分 -->
			<transaction auto-commit="false" mode="FULL_XA" complete-timeout="900000" />
			<persistence passivation="false">
				<!-- トランザクションが有効な場合はpreloadをfalseにする(起動時エラーが発生する) -->
				<file-store path="CacheFiles/${eimCacheNodeName}" />
			</persistence>
			<state-transfer timeout="9223372036854775807" />
		</replicated-cache-configuration>

		<!-- システム管理情報用個別設定 -->
		<replicated-cache name="ObjectType" configuration="Common" />
		<replicated-cache name="Ref_ObjectType_DefinitionName" configuration="Common" />
		<replicated-cache name="UpdateLog_ObjectType" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_ObjectType" configuration="Common-Transaction" />

		<replicated-cache name="Format" configuration="Common" />
		<replicated-cache name="Ref_Format_DefinitionName" configuration="Common" />
		<replicated-cache name="UpdateLog_Format" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_Format" configuration="Common-Transaction" />

		<replicated-cache name="Directory" configuration="Common" />
		<replicated-cache name="UpdateLog_Directory" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_Directory" configuration="Common-Transaction" />

		<replicated-cache name="AttributeType" configuration="Common" />
		<replicated-cache name="Ref_AttributeType_DefinitionName" configuration="Common" />
		<replicated-cache name="UpdateLog_AttributeType" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_AttributeType" configuration="Common-Transaction" />

		<replicated-cache name="User" configuration="Common" />
		<replicated-cache name="Ref_User_Code" configuration="Common" />
		<replicated-cache name="Ref_User_Mail" configuration="Common" />
		<replicated-cache name="UpdateLog_User" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_User" configuration="Common-Transaction" />

		<replicated-cache name="Group" configuration="Common" />
		<replicated-cache name="UpdateLog_Group" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_Group" configuration="Common-Transaction" />

		<!-- オブジェクト用共通設定 -->
		<replicated-cache name="Ref_Object_ObjectTypeIdAndName" configuration="Common" />
		<replicated-cache name="Ref_RootObjectType_ObjectId" configuration="Common" />
		<replicated-cache name="UpdateLog_Object" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_Object" configuration="Common-Transaction" />
		<replicated-cache name="InsufficientLog_Object" configuration="Common" />

		<replicated-cache name="Ref_SpecificObjectType_ObjectId" configuration="Common" />
		<replicated-cache name="Ref_Specific_ObjectTypeIdAndName" configuration="Common" />

		<replicated-cache name="File" configuration="Common" />
		<replicated-cache name="UpdateLog_File" configuration="Common-Transaction" />
		<replicated-cache name="Ref_UpdateLog_UpdatedPK_File" configuration="Common-Transaction" />
		<replicated-cache name="InsufficientLog_File" configuration="Common" />

		<!-- オブジェクト用テンプレート設定 -->
		<replicated-cache-configuration name="Object-CacheBase-Template" mode="SYNC">
			<persistence passivation="false">
				<file-store path="CacheFiles/${eimCacheNodeName}" />
			</persistence>
			<state-transfer timeout="9223372036854775807" />
		</replicated-cache-configuration>

		<!-- オブジェクト用個別設定 -->
		<replicated-cache-configuration name="ユーザ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="グループ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ロール" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="オブジェクトタイプ" configuration="Object-CacheBase-Template" />

		<replicated-cache-configuration name="systemセキュリティ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="属性タイプ値マスター" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="属性ツリー" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="属性ツリー他言語" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="属性ツリー所属属性" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ワークフロー設定" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ワークフロー公開処理" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ドキュメント" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ワークスペース" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="受信確認" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ごみ箱" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="ワークスペース固有ごみ箱" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="PDF変換" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="お気に入り" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="マイドキュメント" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="公開通知先エントリー" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="PDF結合" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="PDF分割" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="PDF署名" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="PDFセキュリティ設定" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="署名・暗号化" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="タグ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="属性表示色" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="公開ファイル比較" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="一時格納ファイル" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="メール通知" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="OCR処理" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="URL挿入" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="公開通知テンプレート" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:帳票ワークスペース" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:帳票" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:帳票添付ファイル" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:一時添付ファイル" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:帳票タイプフォルダ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:ステータスタイプ" configuration="Object-CacheBase-Template" />
		<replicated-cache-configuration name="app.form.dev:属性タイプ" configuration="Object-CacheBase-Template" />

		<!-- カスタムオブジェクト用個別設定 -->
<!-- 		<replicated-cache-configuration name="XXXX" mode="SYNC"> -->
<!-- 			<persistence passivation="false"> -->
<!-- 				<file-store path="CacheFiles/${eimCacheNodeName}" /> -->
<!-- 			</persistence> -->
			<!-- メモリ上限を設定する場合 -->
<!-- 			<memory max-count="XXXX" /> -->
<!-- 			<state-transfer timeout="9223372036854775807" /> -->
<!-- 		</replicated-cache-configuration> -->
	</cache-container>
</infinispan>
